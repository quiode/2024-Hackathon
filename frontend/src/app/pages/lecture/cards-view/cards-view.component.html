<div class="w-full flex flex-row flex-wrap justify-evenly border-solid border-2 border-gray-500 rounded-md">
  <div class="basis-full rounded flex flex-row flex-nowrap justify-center m-1 p-1">
    <button (click)="toggleCardForm()"
      class="w-80 h-10 px-5 border-2 border-solid rounded dark:bg-fuchsia-950 bg-fuchsia-700 text-white dark:hover:bg-fuchsia-800 transition-all hover:bg-fuchsia-500">Add
      Bingo
      Card</button>
  </div>

  @if (wantToEdit()){
  <div @formTrigger id="form-section"
    class="mb-2  p-8 rounded shadow-lg w-full max-w-md">
    <h2 class="text-2xl font-bold mb-4 text-gray-800 dark:text-gray-200">New Bingo Card</h2>
    <form id="contact-form" [formGroup]="cardFrom">
      <!--
        <div class="mb-4">
          <label class="block dark:text-gray-200 text-gray-700 text-sm font-bold mb-2" for="title"></label>
          <input id="title" type="text" class="w-full p-2 dark:text-gray-200 border dark:bg-gray-500 dark:border-gray-900 border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-fuchsia-500">
        </div>
      -->
      <div class="mb-4">
        <label class="block dark:text-gray-200 text-gray-700  text-sm font-bold mb-2" for="professor">Professor</label>
        <select formControlName="professor" id="professor"
          [ngClass]="{'border-red-600 border-2': cardFrom.controls.professor.invalid, 'border-gray-300 dark:border-gray-900': cardFrom.controls.professor.valid}"
          class="w-full dark:text-gray-200 dark:bg-gray-500 p-2 border rounded focus:outline-none focus:ring-2 focus:ring-fuchsia-500">
          <option [ngValue]="null" disabled selected>Select a professor</option>
          @for(prof of professors(); track prof.id){
          <option [ngValue]="prof"> {{prof.name}} </option>
          }
        </select>
      </div>
      <div class="mb-6">
        <label class="block dark:text-gray-200 text-gray-700 text-sm font-bold mb-2" for="message">Message</label>
        <textarea formControlName="text" maxlength="100" id="message"
          [ngClass]="{'border-red-600 border-2': cardFrom.controls.text.invalid, 'border-gray-300 dark:border-gray-900': cardFrom.controls.text.valid}"
          class="dark:text-gray-200 dark:bg-gray-500 w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-fuchsia-500"></textarea>
      </div>
      <div class="flex items-center justify-between">
        <button [disabled]="cardFrom.invalid" (click)="onSubmitCard()" id="submit-btn" type="submit"
          [ngClass]="{'dark:hover:bg-fuchsia-800 hover:bg-fuchsia-500 focus:outline-none': cardFrom.valid}"
          class="bg-fuchsia-700 transition-all text-white font-bold py-2 px-4 rounded">
          Submit Card
        </button>
      </div>
    </form>
  </div>
  }

  @if (hasCards()) {
  <hr class="basis-full border-fuchsia-500 dark:border-fuchsia-800 m-4">

  @for (profMap of professorCardMap(); track profMap[0].id) {
  @if (profMap[1].length > 0) {
  <div class="basis-full flex flex-row flex-wrap justify-evenly border-2 border-solid rounded my-2 mx-5">
    <div class="basis-full text-3xl m-5 mb-0">{{ profMap[0].name }}</div>
    <hr class="basis-full border-fuchsia-500 dark:border-fuchsia-800 m-4 mt-0">

    @for (card of profMap[1]; track card.id) {
    <div
      class="basis-full md:basis-1/3 lg:basis-1/4 xl:basis-1/5 p-5 border border-solid rounded dark:bg-fuchsia-950 bg-fuchsia-700 text-white box-border m-2 aspect-video flex flex-row flex-nowrap justify-center">
      <div class="basis-3/4 flex flex-row justify-center items-center">
        <div class="">{{ card.text }}</div>
      </div>
      <div class="border-l border-white h-full"></div>
      <div class="basis-1/4 flex flex-col flex-nowrap justify-evenly items-center">
        <fa-icon [ngClass]="{'text-green-500': hasUpvoted(card)}" (click)="onUpvote(card)" [icon]="up"
          class="hover:bg-gray-500 rounded-full py-1 px-2 transition-all duration-200 hover:cursor-pointer"></fa-icon>
        <div>{{ card.upvotes.length - card.downvotes.length }}</div>
        <fa-icon [ngClass]="{'text-red-500': hasDownvoted(card)}" (click)="onDownvote(card)" [icon]="down"
          class="hover:bg-gray-500 rounded-full py-1 px-2 transition-all duration-200 hover:cursor-pointer"></fa-icon>
      </div>
    </div>
    }
  </div>
  }
  }
  }
</div>